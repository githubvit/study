{% extends 'master.html' %}
{% block css %}
<style>
    /*出现横向滚动条，宽度一定,页面大小固定，栅格全部为xs*/
    .container{
        width: 1200px;
    }
/*瓷画网广告栏和背景*/
    .wbg{
        background-color: white;
        margin-bottom: 0;
    }
    .jumbotron{
        padding-top: 22px;
        padding-bottom: 22px;
    }
/*路径导航a标签字体*/
    ol a{
        color: #7a7a7a;;
    }
/*路径导航去背景和增加下划线去圆角*/
    .breadcrumb{
        background-color: transparent;
        border-bottom: 1px solid;
        border-radius: 0;
    }



/*调整请选择器形radio的 间距和图片大小*/
    .radio-inline {
        padding-left: 0;
        margin-bottom: 5px;
    }
    .radio-inline img{
        width: 100%;
    }



/*隐藏瓷画器型的input单选点*/
    .chqx input{
        display: none;
    }


    /*颜色的input radio对齐*/
    .ch-color .radio-inline{
        vertical-align: 0;
    }
/*隐藏可选外框的input单选点*/
    .kxwk input{
        display: none;
    }
    /*可选外框：没有选择器型和尺寸，规定的缩略图宽和高等*/
    .kxwk-noqx{
        padding:44px;
        width:100%;
        height: 130.31px;
        margin-bottom:0;
        text-align: center
    }

</style>
    {% block dz-css %}{% endblock %}
{% endblock css %}

{% block cont %}
<!-- 增加的内容-->
<!--1，瓷画网广告-->
    <div class="jumbotron wbg min_width">
        <div class="container ">
            <div class="row">
                <div class="col-xs-offset-2 col-xs-2">
                    <a href="index.html">
                        <img  src="/static/images/yhzx_logo.jpg">

                    </a>
                </div>
                <div class="col-xs-offset-1 col-xs-6">
                    <h3 class="text-center">{{ slogn }}</h3>
                </div>
            </div>
        </div>
    </div>
<!--2,路径导航栏-->
    <div class="container path-bar">
        <ol class="breadcrumb">
          <li><a href="index.html">首页</a></li>
          <li><a href="#">{{ dzgy }}</a></li>
          <li class="active">定制</li>
        </ol>
    </div>
<!--3,详细页面-->
    <div class="container">
        <!--定制和结算-->
        <div class="row">
            <div class="col-xs-10">
                <div class="panel panel-primary">
                    <div class="panel-heading">
                        <h4 class="panel-title">
                            {{ dzgy }}定制
                        </h4>
                    </div>
                    <div class="panel-body">
                        <div class="col-xs-5">
                            {% block tupian %}{% endblock %}
                        </div>
                        <div class="col-xs-7">
                        <!--器型及尺寸-->
                            <h4 >请选择器形及尺寸</h4>
                            <div id="myCarousel" class="carousel slide" data-interval="false" ><!--data-interval如果为 false，轮播将不会自动循环-->
                                <div class="carousel-inner">
                                    {% block qixin %}{% endblock %}
                                </div>
                            </div>
                            <!--器形控制部分-->
                            <div class="row">
                                <div class="col-xs-3 ">
                                    <a class="btn btn-default  btn-xs" href="#myCarousel"  data-slide="prev">
                                        <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                                        <span class="sr-only">Previous</span>
                                    </a>
                                    <a class="btn btn-default  btn-xs" href="#myCarousel"  data-slide="next">
                                        <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                                        <span class="sr-only">Next</span>
                                    </a>
                                </div>
                                <div class="col-xs-4 chqx-hide hidden" >
                                    <span id="qx1" class="chqx-span" style="margin-top: 0;font-weight: bold"></span>
                                </div>
                            </div>

                            {% block dzpannel-cont %}
                                {% endblock %}
                        </div>
                        {% block dz-jh %}{% endblock dz-jh %}
                    </div>
                </div>
            </div>

            <!--定制清单栏-->
            <div class="col-xs-2 ">
                <div class="panel panel-primary" style="margin-bottom: 20px">
                    <div class="panel-heading">
                        <h4 class="panel-title">清单</h4>
                    </div>
                    {% block qidan %}{% endblock %}
                </div>
                <p style="width: 100%">
                    <button id="scwj" class="btn btn-danger" style="width: 100%;margin-bottom: 6px" disabled="disabled">上传图片 支付定金</button>
                </p>
                <p style="width: 100%">
                    <button id='jrgwc'class="btn btn-primary" style="width: 100%"  disabled="disabled">加入购物车</button>
                </p>
            </div>
        </div>
        <hr>
        <!--可选外框-->
        <div class="row ">
            <div class="col-xs-12"><!--不套这一层，面板的两侧会突出来，和上面的两侧对不齐-->
                <div class="panel panel-primary" style="margin-bottom: 26px">
                    <div class="panel-heading">
                        <h4 class="panel-title">可选外框</h4>
                    </div>
                    <div class="panel-body">
                        <div class="col-xs-4">
                            <a href="#">
                                <img class="img-responsive" src="/static/images/1.jpg">
                            </a>
                        </div>

                        <div class="col-xs-8">
                            <div class="thumbnail kxwk-noqx hidden">
                                <p >这是外框选择区，请先选择器型和尺寸。</p>
                            </div>
                            <div class="kxwk-div hidden">
                                <div id="kxwk" class="carousel slide" data-interval="false" ><!--data-interval如果为 false，轮播将不会自动循环-->
                                    <div class="row">
                                        <!--可选外框左控制部分-->
                                        <div class="col-xs-1" >
                                            <a href="#kxwk"  data-slide="prev">
                                                    <span class="glyphicon glyphicon-chevron-left" style="float: right; line-height: 4;" aria-hidden="true"></span><!--line-height用来控制行高，保证按钮居中-->
                                                    <span class="sr-only">Previous</span>
                                            </a>
                                        </div>
                                        <div class="col-xs-10">
                                            <div class="carousel-inner " id="kxwk-div">

                                            </div>
                                        </div>
                                        <!--可选外框右控制部分-->
                                        <div class="col-xs-1">
                                            <a href="#kxwk"  data-slide="next">
                                                <span class="glyphicon glyphicon-chevron-right" style="line-height: 4;" aria-hidden="true"></span>
                                                <span class="sr-only">Next</span>
                                            </a>
                                        </div>
                                    </div>
                                </div>
                                <div class="row" style="margin-top: 18px">

                                    <div class="kxwk-hide hidden" style="display: inline-block;margin-left: 150px">
                                        <span id="wk" class="kxwk-span" style="margin-top: 0;font-weight: bold"></span>
                                    </div>
                                    <p class="pull-right" style="margin-bottom: 0">
                                        <button id="kxwk-qd" class="btn btn-danger"   disabled="disabled">加入清单</button>
                                    </p>

                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            </div>
        </div>
        <hr>
        <!--广告和说明-->
        <div class="row ">
            <div class="col-xs-12"><!--不套这一层，面板的两侧会突出来，和上面的两侧对不齐-->
                <div class="panel panel-primary" style="margin-bottom: 26px">
                <div class="panel-heading">
                    <h4 class="panel-title">关于定制</h4>
                </div>
                <div class="panel-body">
                    <div class="col-xs-2">
                        <p>广告栏/推荐栏</p>
                        <a href="#">
                            <img class="img-responsive" src="/static/images/xh.jpg">
                        </a>
                    </div>
                    <div class="col-xs-8">
                        <ul class="nav nav-tabs">
                          <li role="presentation" class="active"><a href="#">定制说明</a></li>
                          <li role="presentation"><a href="#">问与答</a></li>
                          <li role="presentation"><a href="#">其他</a></li>
                        </ul>
                        <div style="margin-top: 33px">
                            <div class="wrapper">
                                <div class="content-main"><h4>瓷板画定制流程，只要4步</h4></div>
                                <div class="content-secondary">
                                    <p>1，选择瓷板外形及尺寸。</p>
                                    <p>2，选择瓷板画类型（肖像、山水、生活等）及作者等。</p>
                                    <p>3，直接上传您要定制的图片。</p>
                                    <p>4，只要付40%定金我们就开始设计瓷板画图样，图样经过您的确认满意后，再付余款，制成瓷板画发货。</p>
                                </div>
                            </div>
                            <div class="wrapper">
                                <div class="content-secondary">
                                    <img src="/static/images/cb1.jpg">
                                    <img src="/static/images/cb2.jpg">
                                    <img src="/static/images/cb3.jpg">
                                    <img src="/static/images/cb4.jpg">
                                    <img src="/static/images/cb5.jpg">
                                    <img src="/static/images/cb6.jpg">
                                    <img src="/static/images/cb7.jpg">
                                    <img src="/static/images/cb8.jpg">
                                    <img src="/static/images/cb9.jpg">
                                    <img src="/static/images/cb10.jpg">
                                    <img src="/static/images/cb11.jpg">
                                    <img src="/static/images/cb12.jpg">
                                    <img src="/static/images/cb13.jpg">
                                    <img src="/static/images/cb14.jpg">
                                    <img src="/static/images/cb15.jpg">
                                    <img src="/static/images/cb16.jpg">
                                    <img src="/static/images/cb17.jpg">
                                    <img src="/static/images/cb18.jpg">
                                    <img src="/static/images/cb19.jpg">
                                    <img src="/static/images/cb20.jpg">
                                    <img src="/static/images/cb21.jpg">
                                    <img src="/static/images/cb22.jpg">
                                    <img src="/static/images/cb23.jpg">
                                    <img src="/static/images/cb24.jpg">
                                    <img src="/static/images/cb25.jpg">
                                    <img src="/static/images/cb26.jpg">
                                    <img src="/static/images/cb27.jpg">
                                    <img src="/static/images/cb28.jpg">
                                    <img src="/static/images/cb29.jpg">
                                    <img src="/static/images/cb31.jpg">
                                    <img src="/static/images/cb32.jpg">
                                    <img src="/static/images/cb33.jpg">
                                    <img src="/static/images/cb34.jpg">
                                    <img src="/static/images/cb35.jpg">
                                    <img src="/static/images/cb36.jpg">
                                    <img src="/static/images/cb37.jpg">
                                    <img src="/static/images/cb38.jpg">
                                    <img src="/static/images/cb39.jpg">
                                    <img src="/static/images/cb40.jpg">
                                    <img src="/static/images/cb41.jpg">
                                    <img src="/static/images/cb42.jpg">
                                    <img src="/static/images/cb43.jpg">
                                    <img src="/static/images/cb44.jpg">
                                    <img src="/static/images/cb45.jpg">
                                    <img src="/static/images/cb46.jpg">
                                    <img src="/static/images/cb47.jpg">
                                    <img src="/static/images/cb48.jpg">
                                    <img src="/static/images/cb49.jpg">
                                    <img src="/static/images/cb50.jpg">
                                    <img src="/static/images/cb51.jpg">
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-xs-2">
                        <p>广告栏/推荐栏</p>
                        <a href="#">
                            <img class="img-responsive" src="/static/images/xh.jpg">
                        </a>
                    </div>
                </div>
            </div>
            </div>
        </div>


    </div>
<!-- 增加的内容结束-->
{% endblock cont %}

{% block js %}
    {% block dz-js %}{% endblock %}
<script>
    $(function () {

//   瓷画器型开始载入时
        chqx();
        // 加载尺寸函数
        chqx_size();
        //颜色控制函数
        ch_color();
        //可选外框函数
        kxwk();
        //加入清单
        jrqd();


//   瓷画器形控制
        $('.chqx :input[name="ch-qx"]').change(function () {
//             Click事件是选择列表项，而Change事件则是编辑内容，不是这样的，内容改变
// 这两个事件的结果都是使ComboBox控件中的现实内容发生变化，但是一个是通过鼠标点击，即Click；另一个是通过在输入框中编辑内容，即Change。
            console.log(1);
//            加载器型函数
            chqx();
            // 加载尺寸函数
            chqx_size();
            //加载外框函数
            kxwk();
            //加入清单
            jrqd();

            price ();
        });

//        颜色控制
        $('.ch-color :input[name="ch-color"]').change(function () {
            ch_color();
        });


        // 可选外框,要用委托绑定
        $('#kxwk-div').delegate(':radio[name="kxwk"]','change',function () {
            console.log('可选外框');
            kxwk();
        });
        //加入清单
        $('#kxwk-qd').click(function () {
            jrqd();
            price();
        });


    });

//    器型显示控制 控制尺寸选项及控制外框种类
    function chqx() {
        //获取器型单选是否已选，ture或undifend
        var qx=$(':radio[name="ch-qx"]:checked').prop('checked');
        //删除原尺寸选择下拉框中的列表除第1项外的其余选项标签。
        $('#size-st option:not(:first)').remove();
        if (qx){
            //如果为true，那么获取单选框选择的tb-name属性的值
            var chqx=$(':radio[name="ch-qx"]:checked').attr('tb-name');
            //将器型单选框的tb-name属性的值传给所有器型的span标签
            $('.chqx-span').html(chqx);
        //通过ajax上传该器型ID，获取该器型所有尺寸值列表，用ajax方式不刷新页面
            //创建器型和尺寸的数据结构：{器型id：尺寸列表}，满足不同的器型有不同的尺寸列表
            var size_dict={1:[7,8,9],2:[8,9,10],3:[8,9,10],4:[9,10,11],5:[10,11,12],6:[11,12,13],7:[12,13,14],8:[13,14,15],9:[14,15,16]};
            //获取选中的器型id
            var chqx_id=$(':radio[name="ch-qx"]:checked').val();
            //将选中的器型id的尺寸列表放到尺寸选择框中，生成option选项
            for (var i=0;i<size_dict[chqx_id].length;i++){
                //创建标签<option>
//                获取该尺寸列表size_dict[chqx_id]该轮循环的值
                var vl=size_dict[chqx_id][i];
                var op1='<option value='+vl+' tb-name="'+vl+'寸">'+vl+'寸'+'</option>';
                //insertAdjacentHTML字符串形式插入标签，该方式只能是document.getElementBy..方式因此用$('#size-st')[0]
                $('#size-st')[0].insertAdjacentHTML('beforeEnd',op1)
            }

            //如果是通过参考定制进来的应该再让参考链接的尺寸值被选中
            //             假设尺寸的value值是8，设置select的值
            // $('select[name="size"] option[value="8"]').prop('selected',true);

//对于可选外框的控制，
        // 1，清除外框轮播器中的item
            $('#kxwk-div').children().remove();
        // 2，获取选中器型的可选外框列表轮播
            //创建轮播列表 器型id:[[wk1_name,wk1_img_src],[wk2_name,wk2_img_src],...]，应该有外框种类id器型id:[[wk1_name,wk1_img_src],[wk2_name,wk2_img_src],...]，这里暂时用循环值代替
            var wk_dict={
                1:[['外框1','/static/images/1.jpg'],['外框2','/static/images/2.jpg'],['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg'],['外框7','/static/images/2.jpg']],
                2:[['外框2','/static/images/2.jpg'],['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg']],
                3:[['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg'],['外框7','/static/images/2.jpg']],
                4:[['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg'],['外框7','/static/images/2.jpg'],['外框8','/static/images/3.jpg']],
                5:[['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg'],['外框7','/static/images/2.jpg'],['外框8','/static/images/3.jpg']],
                6:[['外框1','/static/images/1.jpg'],['外框2','/static/images/2.jpg'],['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg']],
                7:[['外框2','/static/images/2.jpg'],['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg']],
                8:[['外框3','/static/images/3.jpg'],['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg']],
                9:[['外框4','/static/images/4.jpg'],['外框5','/static/images/5.jpg'],['外框6','/static/images/1.jpg'],['外框7','/static/images/2.jpg']]
            };
        //3，创建轮播外框的item/row/////col-xs3/input-lable *************
            //第一步，构建轮播外层item/row/，用wk_dict[chqx_id].length的值整除4，来构建看有几个item，并在item层构建class item-0、item-1、。。。
            for(var j=0;j<wk_dict[chqx_id].length/4;j++){

                var tem='<div class="item item-'+j+'"> <div class="row kxwk"></div></div>';
                //插入到外框轮播图外框里
                $('#kxwk-div')[0].insertAdjacentHTML('beforeEnd',tem);

            }
            //激活item-0
            $('.item-0').addClass('active');

            //第二步，构建轮播内层，在上面刚创建的item-n里添加col-xs3/input-lable，m暂时取代外框种类id
            for(var m=0;m<wk_dict[chqx_id].length;m++){
                //定义标签内容
                var tmp='<div class="col-xs-3"> ' +
                        '<input type="radio" name="kxwk" id="kxwk' +m+
                    '" value="'+m+'" tb-name="'+wk_dict[chqx_id][m][0]+'">'+
                            '<label  class="radio-inline" for="kxwk'+m+'">'+
                                '<img class="img-responsive img-thumbnail" src="'+wk_dict[chqx_id][m][1]+'" >'+
                                '<span style="display: inline-block">'+wk_dict[chqx_id][m][0]+
                    '</span> </label></div>';

                //定义位置变量--用当前下标除4取整
                var di=m/4|0;

                //在相应item位置插入标签
                $('.item-'+di+' .kxwk')[0].insertAdjacentHTML('beforeEnd',tmp)
            }
//            打开可选外框
            $('.kxwk-noqx').addClass('hidden').next().removeClass('hidden');
            //移除器型控制的隐藏部分
            $('.chqx-hide').removeClass('hidden');

        }else{
            //如果不为true，将器型控制的隐藏部分隐藏
            $('.chqx-hide').addClass('hidden');
            //            将外框隐藏
            $('.kxwk-noqx').removeClass('hidden').next().addClass('hidden');
        }
    }

    //外框控制函数
    function kxwk() {
//        获取可选外框的radio值是false还是ture，就是是否有选中的。
        var kxwk_tag=$(':radio[name="kxwk"]:checked');
        var kxwk=kxwk_tag.prop('checked');
        //器型尺寸是否不为0
        var p2=$('select[name="size"] option:selected').val();//尺寸
        if(kxwk&&p2){
            //外框名称
            var kxwk_name=$(':radio[name="kxwk"]:checked').attr('tb-name');
            //被选中外框单价
            var kxwk_price=$(':radio[name="kxwk"]:checked').next().children('.kxwk-price').text();
            var kxwk_px='<span class="pull-left" style="display: inline-block;padding-left: 15px">匹配器型：'+
                $('select[name="size"] option:selected').attr('tb-name')+$(':radio[name="ch-qx"]:checked').attr('tb-name')+'</span>';
            var kxwk_sv='<span style="display: inline-block;padding-left: 51px">外框名称：'+kxwk_name+
                '</span><span style="display: inline-block;padding-left: 15px;padding-right: 15px;color: red" >外框单价：'+kxwk_price+'</span>';
            var kxwk_span=kxwk_px+kxwk_sv;
            $('.kxwk-hide').removeClass('hidden');
            $('.kxwk-span').html(kxwk_span);
            //置加入清单按钮为可用
            $('#kxwk-qd').removeAttr('disabled');
        }else{
            $('.kxwk-span').html('');
            $('.kxwk-hide').addClass('hidden');
            //置加入清单按钮为disable
            $('#kxwk-qd').attr('disabled','disabled');
        }
    }


//颜色选择函数
    function ch_color() {
        var v=$('.ch-color :input[name="ch-color"]:checked').next().text();
        $('.chys-span').text(v);
        price ();
    }


</script>
<!--参考定制为另外一页-->
{% endblock js %}
