{% extends 'ch_goods/dz-base.html' %}
{% block dz-css %}
<style>

/*调整左边作者画面距离上部的外形画的间距*/
    .fix-img2,.fix-img3{
        margin-top: 14px;
    }


/*调整请选择器形radio的 间距和图片大小*/
    .radio-inline {
        padding-left: 0;
        margin-bottom: 5px;
    }
    .radio-inline img{
        width: 100%;
    }

/*呈现未选择类型时，显示没有选择类型轮播图,为保持该轮播图与选择类型后的轮播图位置不跳跃*/

    #lxzz-no .thumbnail{
        padding:30px;
        width:100%;
        height: 88.31px;
        margin-bottom:22px;
        text-align: center

    }

/*隐藏瓷画器型的input单选点*/
    .chqx input{
        display: none;
    }

/*隐藏瓷画作者的input单选点*/
    .chzz input{
        display: none;
    }
    /*颜色的input radio对齐*/
    .ch-color .radio-inline{
        vertical-align: 0;
    }

/*文字输入框中的位置*/
    .text_1{
        position:absolute;
        z-index:1100;/*不要被提示给挡住了，应该在最外层*/
        width:321px;
        bottom:29px;
        right:0;
    }
    /*文字输入框中textarea的*/
    .textarea_1{

        max-width: 100%;
        max-height: 150px;
        border-top-left-radius: 0;
        border-top-right-radius: 0;
        margin: 0;
    }

</style>
{% endblock dz-css %}


{% block tupian %}
    <img class="img-responsive fix-img1" style="margin-top: 5px" src="/static/images/1.jpg">
    <img class="img-responsive fix-img2" src="/static/images/1.jpg">
    <img class="img-responsive fix-img3" style="margin-bottom: 2px;" src="/static/images/1.jpg">
{% endblock %}

{% block qixin %}
    <div class="item active">
        <div class="row chqx">
            <div class="col-xs-4" >
                <input type="radio" name="ch-qx" id="chqx1" value="1" tb-name="长方形瓷板">
                <label  class="radio-inline" for="chqx1">
                    <img class="img-responsive img-thumbnail" src="/static/images/1.jpg"  >
                    <span style="display: inline-block">长方形瓷板</span>
                </label>
            </div>
            <div class="col-xs-4">
                <input type="radio" name="ch-qx" id="ch-qx2" value="2" tb-name="圆形瓷板">
                <label  class="radio-inline" for="ch-qx2">
                    <img class="img-responsive img-thumbnail" src="/static/images/3.jpg" >
                    <span style="display: inline-block">圆形瓷板</span>
                </label>
            </div>
            <div class="col-xs-4">
                <input type="radio" name="ch-qx" id="ch-qx3" value="3" tb-name="扇形瓷板">
                <label  class="radio-inline" for="ch-qx3">
                    <img class="img-responsive img-thumbnail" src="/static/images/2.jpg" >
                    <span style="display: inline-block">扇形瓷板</span>
                </label>
            </div>
        </div>
    </div>
    <div class="item ">
        <div class="row chqx">
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx4" value="4" tb-name="椭圆形瓷板">
            <label  class="radio-inline" for="ch-qx4">
                <img class="img-responsive img-thumbnail" src="/static/images/4.jpg" >
                <span style="display: inline-block">椭圆形瓷板</span>
            </label>
        </div>
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx5" value="5" tb-name="心形瓷板">
            <label  class="radio-inline" for="ch-qx5">
                <img class="img-responsive img-thumbnail" src="/static/images/5.jpg" >
                <span style="display: inline-block">心形瓷板</span>
            </label>
        </div>
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx6" value="6" tb-name="条形屏风">
            <label  class="radio-inline" for="ch-qx6">
                <img class="img-responsive img-thumbnail" src="/static/images/1.jpg" >
                <span style="display: inline-block">条形屏风</span>
            </label>
        </div>
    </div>
    </div>
    <div class="item ">
        <div class="row chqx">
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx7" value="7" tb-name="横幅中堂">
            <label  class="radio-inline" for="ch-qx7">
                <img class="img-responsive img-thumbnail" src="/static/images/2.jpg" >
                <span style="display: inline-block">横幅中堂</span>
            </label>
        </div>
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx8" value="8" tb-name="其他瓷板1">
            <label  class="radio-inline" for="ch-qx8">
                <img class="img-responsive img-thumbnail" src="/static/images/3.jpg" >
                <span style="display: inline-block">其他瓷板1</span>
            </label>
        </div>
        <div class="col-xs-4">
            <input type="radio" name="ch-qx" id="ch-qx9" value="9" tb-name="瓷瓶">
            <label  class="radio-inline" for="ch-qx9">
                <img class="img-responsive img-thumbnail" src="/static/images/4.jpg" >
                <span style="display: inline-block">瓷瓶</span>
            </label>
        </div>
    </div>
    </div>
{% endblock %}

{% block dzpannel-cont %}
<!--尺寸选择-->
<div class="row" style="margin-top: 10px">
    <div class="col-xs-3">
        <div class="chqx-size">
            <select name="size" class="form-control input-sm" id="size-st">
                <option value tb-name="">请选择尺寸</option>

            </select>
        </div>
    </div>
</div>
<!--画面类型及作者-->
<h4 style="margin-top: 36px;">请选择画面类型、作者及颜色、文字</h4>
<div id="chlx" >
    <div class="row">
        <!--画面类型选择-->
        <div class="col-xs-3">
            <select name="ch-type" class="form-control input-sm" id="chty-st">
                <option value="0" tb-name="">请选择类型</option>
                <option value="1" tb-name="人物">人物</option>
                <option value="2" tb-name="人物和动物">人物和动物</option>
                <option value="3" tb-name="宠物、动物">宠物、动物</option>
                <option value="4" tb-name="风景、山水">风景、山水</option>
            </select>
        </div>
        <!--人数和动物数量选择 选项和尺寸相关-->
        <div class="col-xs-3 hidden">
            <!--人物和动物数量跟尺寸相关-->
            <select  name="ch-rs" class="form-control input-sm" id="ch-rs">
                <option value="0">请选择人数</option>
            </select>
        </div>
        <div class="col-xs-4 hidden" style="padding-left: 0;">
            <select  name="ch-rds" class="form-control input-sm" id="ch-rds">
                <option value="0">请选择人和动物数</option>
            </select>
        </div>
        <div class="col-xs-3 hidden">
            <select  name="ch-ds" class="form-control input-sm" id="ch-ds" style="padding-left: 1px">
                <option value="0">请选择动物数</option>
            </select>
        </div>
    </div>
</div>
    <!--瓷画作者选择<div class="row"> 加了row位置就往左偏移-->
<div class="chzz-div" style="margin-bottom: 15px">
    <!--类型未选择轮播图，要先hidden，不然会闪-->
    <div id="lxzz-no" class="carousel slide hidden" data-interval="false"  style="margin-top: 10px">
        <div class="carousel-inner">
            <div class="item active" >
                <div class="row chzz">
                    <div class="no-type">
                        <div class="thumbnail" >
                            <p >这是作者选择区，需要您先选择画面类型。</p><!---->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--类型选择后轮播图，也要先hidden，不然会闪-->
    <div id="chzz" class="carousel slide hidden" data-interval="false"  style="margin-top: 10px">
        <div class="carousel-inner">
            <div class="item active">
                <div class="row chzz">
                    <div class="col-xs-4" >
                        <input type="radio" name="ch-zz" id="ch-zz1" value="1" tb-name="作者1">
                        <label  class="radio-inline" for="ch-zz1">
                            <img class="img-responsive img-thumbnail" src="/static/images/1.jpg"  >
                            <span style="display: inline-block">作者1</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >1周</span>
                        </label>
                    </div>
                    <div class="col-xs-4">
                        <input type="radio" name="ch-zz" id="ch-zz2" value="2" tb-name="作者2">
                        <label  class="radio-inline" for="ch-zz2">
                            <img class="img-responsive img-thumbnail" src="/static/images/3.jpg" >
                            <span style="display: inline-block">作者2</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >1周</span>
                        </label>
                    </div>
                    <div class="col-xs-4">
                        <input type="radio" name="ch-zz" id="ch-zz3" value="3" tb-name="作者3">
                        <label  class="radio-inline" for="ch-zz3">
                            <img class="img-responsive img-thumbnail" src="/static/images/2.jpg" >
                            <span style="display: inline-block">作者3</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >2周</span>
                        </label>
                    </div>
                </div>
            </div>
            <div class="item">
                <div class="row chzz">
                    <div class="col-xs-4" >
                        <input type="radio" name="ch-zz" id="ch-zz4" value="4" tb-name="作者4">
                        <label  class="radio-inline" for="ch-zz4">
                            <img class="img-responsive img-thumbnail" src="/static/images/5.jpg"  >
                            <span style="display: inline-block">作者4</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >2周</span>
                        </label>
                    </div>
                    <div class="col-xs-4">
                        <input type="radio" name="ch-zz" id="ch-zz5" value="5" tb-name="作者5">
                        <label  class="radio-inline" for="ch-zz5">
                            <img class="img-responsive img-thumbnail" src="/static/images/4.jpg" >
                            <span style="display: inline-block">作者5</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >3周</span>
                        </label>
                    </div>
                    <div class="col-xs-4">
                        <input type="radio" name="ch-zz" id="ch-zz6" value="6" tb-name="作者6">
                        <label  class="radio-inline" for="ch-zz6">
                            <img class="img-responsive img-thumbnail" src="/static/images/3.jpg" >
                            <span style="display: inline-block">作者6</span>
                            <!--预计图样交付时间ch-dt，如果该作者手上已经有1单，则时间会相应往后推迟1周
                                图样交付时间等于该作者手上已有单的剩余交付时间+该单的图样默认交付时间（1周）
                            -->
                            <span style="display: inline-block; color: red" class="pull-right ch-dt" >3周</span>
                        </label>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!--瓷画作者控制部分-->
    <div class="row">
        <div class="col-xs-3" style="margin-right: -30px" >
            <a class="btn btn-default btn-sm btn-xs" href="#chzz"  data-slide="prev">
                <span class="glyphicon glyphicon-chevron-left" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="btn btn-default btn-sm btn-xs" href="#chzz"  data-slide="next">
                <span class="glyphicon glyphicon-chevron-right" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <div class="col-xs-5 chzz-hide hidden" style="padding-left:10px">
            <span id="zz" class="chzz-span " style="margin-top: 0;font-weight: bold"></span>
            <!--该作者图样交付时间-->
            <span>当前图样交付时间:</span>
            <span id="chdt" class="chdt-span" style="margin-top: 0;font-weight: bold"></span>
        </div>
    </div>
</div>
    <!--颜色选择-->
<span style="font-size: 16px">请选择颜色</span>
<div class="ch-color" style="display: inline-block;margin-left: 15px;">
    <input id="ch-color1" type="radio" name="ch-color" value="1" tb-name="黑白">
    <label class="radio-inline" for="ch-color1" style="margin-right: 18px">黑白</label>
    <input id="ch-color2" type="radio" name="ch-color" value="2" tb-name="彩色" checked="checked">
    <label class="radio-inline" for="ch-color2">彩色</label>
</div>
<!--画面中是否有字-->

<span style="margin-left: 31px;font-size: 16px">是否有文字</span>
<div class="ch-font" style="display: inline-block;margin-left: 15px;">
    <input id="ch-font1" type="radio" name="ch-font" value="1" tb-name="无" checked="checked">
    <label class="radio-inline" for="ch-font1" style="margin-right: 18px">无</label>
    <input id="ch-font2" type="radio" name="ch-font" value="2" tb-name="有">
    <label class="radio-inline" for="ch-font2">有</label>
    <button id='font-btn' class="btn btn-default btn-xs hidden" >编辑画面文字</button>
    <div id="font-edit" class="hidden text_1" >
        <div class="panel panel-default">
            <div class="panel-heading" style="padding: 5px 15px;">
                <span class="panel-title" style="font-size: 11px">编辑画面文字</span>
                <a id='font-submit' class="pull-right" style="cursor: pointer;color: inherit">
                    <span class="glyphicon glyphicon-remove"></span>
                </a>
            </div>
            <div class="panel-body" style="padding: 0;" >
                <textarea id="font-context"  class="form-control textarea_1" style="width: 331px;height: 166px;" placeholder="请在这里输入画面上的文字，20个字符以内免费，最多为100个字符。" maxlength="100" ></textarea>
            </div>
        </div>
    </div>
</div>

{% endblock %}

{% block qidan %}
    <div class="panel-body" style="height: 369px;padding-top: 9px">
        <div class="price1" style="margin-top: 0;line-height: 1.3;">
            <p>工艺：<span >{{ dzgy }}</span></p>
            <p>器型：<span class="chqx-span"></span></p>
            <p>尺寸：<span class="size-span"></span></p>
            <p>类型：<span class="chlx-span"></span></p>
            <p class="hidden">人数：<span class="chrs-span"></span></p>
            <p class="hidden">人和动物数：<span class="chrds-span"></span></p>
            <p class="hidden">动物数：<span class="chds-span"></span></p>
            <p>作者：<span class="chzz-span"></span></p>
            <p>图样：<span class="chdt-span"></span></p>
            <p>颜色：<span class="chys-span"></span></p>
            <p class="hidden">字数：<span class="font-span"></span></p>
        </div>
        <div style="line-height: 1">
            <p style="color: red;">单价：<span style="padding-left: 15px">¥</span><span id="ch-djia" style="font-size: 18px"></span></p>
            <p style="color: red">定金：<span style="padding-left: 15px">¥</span><span id="ch-djin" style="font-size: 18px"></span></p>
            <p class="hidden" style="color: red">
                外框：<span >¥</span>
                <span id="wk-dj" style="font-size: 18px;text-decoration-line: underline;"></span>
                <a id="ycwk" style="cursor: pointer;margin-left: 5px; color: red;" data-toggle="tooltip" title="移除"><i class="icon-remove-circle"></i></a>
            </p>
            <p class="hidden" style="color: red">总价：<span style="padding-left: 15px">¥</span><span id="ch-zj" style="font-size: 18px"></span></p>
        </div>
    </div>
{% endblock %}

{% block dz-js %}
    <script>
    $(function () {
        // 类型控制函数
        lxzz();
        // 作者控制函数
        chzz();
        // 头像数控制
        txs();
        // 字数统计函数
        font_world();
        // 一，尺寸控制
        $('#size-st').change(function () {
            // 加载尺寸函数
            chqx_size();
            // 将人数或其他数的span置空
            $('.chrs-span').html('');
            $('.chrds-span').html('');
            $('.chds-span').html('');
            //加载外框函数，当改变尺寸时，外框跟着变，而不是简单清空
            kxwk();
            //加入清单
            jrqd();
            price ();
        });
        // 二，瓷画类型控制
        $('#chty-st').change(function () {
            lxzz();
            txs();
            chzz();
            price ();
        });
        // 三，瓷画作者控制
        $('.chzz :input[name="ch-zz"]').change(function () {
            chzz();
            price();
        });
        // 四， 字数控制
        // 1,当name=ch-font的input单选框的值为value=2时，去掉‘编辑画面文字’按钮(id='font-btn')的隐藏，以及清单中font-span标签的父标签的隐藏；否则都隐藏
        $(':radio[name="ch-font"]').change(function () {
            font_world();
            price();
        });
        //  2，当‘编辑画面文字’按钮被点击，去除textarea文件编辑框的隐藏，可以输入画面文字，
        $('#font-btn').click(function () {
            $('#font-edit').removeClass('hidden');
        });
        //  * 2.1，捕捉textarea的input事件，同时，进行编辑框中字数统计，并把字数统计结果给到清单中的font-span标签；
        $('#font-context').on("input propertychange",function () {
             var font_val=$('#font-context').val();
            //匹配非空字符,用正则\S匹配非空字符，g和m表示整个字符串和多行
            var font_rs=font_val.match(/\S/gm);
            if(font_rs){//如果有非空字符，则计算长度和给清单中的font-span中同步字数
                //获得匹配后的非空字符串，用length取得长度，这个长度就是非空的长度
                var font_num=font_rs.length;
                //  给清单中的font-span中同步字数
                $('.font-span').html(font_num);
            }else{
                $('.font-span').html('');//清空清单里font-span中的内容
            }
            price();
        });
        //  * 2.2，点击确定按钮，又隐藏该编辑框，同时，进行编辑框中字数统计，并把字数统计结果给到清单中的font-span标签；
        $('#font-submit').click(function () {
            //取得textarea的值
            var font_val=$('#font-context').val();
            //匹配非空字符,用正则\S匹配非空字符，g和m表示匹配整个字符串和多行匹配
            var font_rs=font_val.match(/\S/gm);
            if(font_rs){//如果有非空字符，则计算长度和给清单中的font-span中同步字数
                //获得匹配后的非空字符串，用length取得长度，这个长度就是非空的长度
                var font_num=font_rs.length;
                //给清单中的font-span中同步字数
                $('.font-span').html(font_num);
            }else{
                $('.font-span').html('');//清空清单里font-span中的内容
            }
            $('#font-edit').addClass('hidden');
            price();

        });

        //  五，头像数控制
        // 人数控制
        $('#ch-rs').change(function () {

            if($(this).val()!=='0'){
                $('.chrs-span').html($(this).val());

            }else{
                $('.chrs-span').html('');
            }
            price ();

        });

        //  人和动物数控制
        $('#ch-rds').click(function () {
            if($(this).val()!=='0'){
                $('.chrds-span').html($(this).val());

            }else{
                $('.chrds-span').html('');
            }
            price ();
        });
        //  动物数控制
        $('#ch-ds').change(function () {

            if($(this).val()!=='0'){
                $('.chds-span').html($(this).val());

            }else{
                $('.chds-span').html('');
            }
            price ()
        });
        // 六，头像数的提示事件，只能通过点击事件判断
        /*
        * 如果ch-rs下拉框只有一个option选项
        * 则给出提示，否则去除提示
        * */
        $('#ch-rs,#ch-rds,#ch-ds').click(function () {
            //去除旧的提示
            $('.tip1').remove();
            //定义提示标签
            var tip='您当前还未选择尺寸或选择的尺寸太小';
            var tag='<span class="tip1" style="color: red;position: absolute;right: -230px; bottom: 0px;z-index: 111">'+tip+'</span>';
            if($(this).children().length===1){
                //增加提示
                $(this)[0].insertAdjacentHTML('afterEnd',tag)
            }else{
                //去除提示
                $('.tip1').remove();
            }
        });
        //在清单移除外框
        $('#ycwk').click(function () {
            //置外框的span为空
             $('#wk-dj').text('');
             //将#wk-dj的父标签隐藏
            $('#wk-dj').parent().addClass('hidden');
            //置总价的span为空
            $('#ch-zj').text('');
            //将总价的父标签解除隐藏
            $('#ch-zj').parent().addClass('hidden');
        })
    });
    //    价格函数
    function price () {
//        器型 :radio[name="ch-qx"] 作者：:radio[name="ch-zz"] 颜色：:radio[name="ch-color"]
//        尺寸 select[name="size"] 外框：select[name="ch-wk"] 类型：select[name="ch-type"]
//        人数 select[name="ch-rs"] 人和动物数 select[name="ch-rds"] 动物数：select[name="ch-ds"]
        var p1=$(':radio[name="ch-qx"]:checked').val();// 器型
        var p2=$('select[name="size"] option:selected').val();//尺寸
//        var p3=$('select[name="ch-wk"] option:selected').val();//外框
        var p4=$('select[name="ch-type"] option:selected').val();//类型
        var p5=$(':radio[name="ch-zz"]:checked').val();//作者
        var p6=$(':radio[name="ch-color"]:checked').val();//颜色
        var p7=$('select[name="ch-rs"] option:checked').val();//人数
        var p8=$('select[name="ch-rds"] option:checked').val();//人和动物数
        var p9=$('select[name="ch-ds"] option:checked').val();//动物数
        //对于字数的计算
        /*
        * 1,如果radio[name="ch-font"]:checked value===1,就表示无字符，置p10=0；就是让字数等于0；
        * 2,如果radio[name="ch-font"]:checked value===2,表示有字符，清单中的font-span标签应该有内容，$('.font-span').text()
        * 2.1，非空字数<=20,置p10=0；就是让字数等于0；20个字符以内免费。
        * 2.2，非空字数>20,置p10=字数-20；从第21个开始算钱。
        * 2.3，非空字符没结果，则，置p10=false，为假，不让结算.
        * */
        if($(':radio[name="ch-font"]:checked').val()==='1'){
            var p10=1;
        }else{
            if($('.font-span').text()){
                if(parseInt($('.font-span').text())<=20){
                    var p10=1;
                }else{
                    var p10=parseInt($('.font-span').text())-20;
                }
            }else{
                var p10=false;
            }
        }
        console.log('p1:'+p1);
        console.log('p2:'+p2);
//        console.log('p3:'+p3);
        console.log('p4:'+p4);
        console.log('p5:'+p5);
        console.log('p6:'+p6);
        console.log('p7:'+p7);
        console.log('p8:'+p8);
        console.log('p9:'+p9);
        console.log('p10:'+p10);
        if(p4==='1'){
            if(p1 && p2 && p5 && p6 && p7!=='0' && p10){
               var price1=p2*10+p5*30*p7+p6*15+p10*5;
            }else{
                $('#ch-djia').html('');
                $('#ch-djin').html('');
                $('#scwj').attr('disabled','disabled');
                $('#jrgwc').attr('disabled','disabled');
                $('#ch-zj').html('');
                return
            }

        }else if(p4==='2'){
            if(p1 && p2 && p5 && p6 && p8!=='0' && p10){
               var price1=p2*10+p5*30*p8+p6*15+p10*5;
            }else{
                $('#ch-djia').html('');
                $('#ch-djin').html('');
                $('#scwj').attr('disabled','disabled');
                $('#jrgwc').attr('disabled','disabled');
                $('#ch-zj').html('');
                return
            }
        }else if(p4==='3'){
            if(p1 && p2 && p5 && p6 && p9!=='0' && p10){
               var price1=p2*10+p5*30*p9+p6*15+p10*5;
            }else{
                $('#ch-djia').html('');
                $('#ch-djin').html('');
                $('#scwj').attr('disabled','disabled');
                $('#jrgwc').attr('disabled','disabled');
                $('#ch-zj').html('');
                return
            }
        }else{
            if(p1 && p2 && p5 && p6 && p4 && p10){
                var price1=p2*10+p5*30+p6*15+p10*5;
            }else{
                $('#ch-djia').html('');
                $('#ch-djin').html('');
                $('#scwj').attr('disabled','disabled');
                $('#jrgwc').attr('disabled','disabled');
                $('#ch-zj').html('');
                return
            }
        }
        var djin=price1*0.4;
        $('#ch-djia').html(price1.toFixed(2));
        $('#ch-djin').html(djin.toFixed(2));
        $('#scwj').removeAttr('disabled');
        $('#jrgwc').removeAttr('disabled');
        //当外框被选时，总价，这个外框的价格不能选$(':radio[name="kxwk"]:checked')的价格，要选加入清单的价格，因为即使在可选外框选了，也不见得会加入清单
        var wk_price=$('#wk-dj').text();//将text字符串转为数字
        var ch_zj=parseFloat(price1)+parseFloat(wk_price);//保持类型一致，不然会报NaN；
        //把ch-zj放入

        $('#ch-zj').html(ch_zj.toFixed(2));


    }
    //    头像数量select下拉框控制
    function txs() {
        //获取类型的值
        var v=$('#chty-st').val();
        if(v==='1'){
            $('#ch-rs').parent().removeClass('hidden');
            $('.chrs-span').parent().removeClass('hidden');
        }else{
            $('#ch-rs').parent().addClass('hidden');
            $('.chrs-span').parent().addClass('hidden');
        }
        if(v==='2'){
            $('#ch-rds').parent().removeClass('hidden');
            $('.chrds-span').parent().removeClass('hidden');

        }else{
            $('#ch-rds').parent().addClass('hidden');
            $('.chrds-span').parent().addClass('hidden');
        }
        if(v==='3'){
            $('#ch-ds').parent().removeClass('hidden');
            $('.chds-span').parent().removeClass('hidden');

        }else{
            $('#ch-ds').parent().addClass('hidden');
            $('.chds-span').parent().addClass('hidden');
        }

    }
    //    类型控制函数
    function lxzz() {
        //每次类型操作的时候都要置作者的radio项为空，因为每种类型的作者不同
        $(':input[name="ch-zz"]:checked').prop("checked",false);
        if($('#chty-st').val()==='0'){
//            打开没有选择类型，作者轮播图隐藏
            $('#lxzz-no').removeClass('hidden').siblings().addClass('hidden');
            $('.chlx-span').html('');
        }else{
//            作者轮播图出现
            $('#lxzz-no').addClass('hidden').siblings().removeClass('hidden');
            var lx_tb=$('select[name="ch-type"] option:selected').attr('tb-name');
            $('.chlx-span').html(lx_tb);
        }
    }
      //尺寸函数 控制外框 控制头像数量
    function chqx_size() {
        console.log('chqx_size');
       //获取尺寸选择下拉框是否已选，是不行的，因为第一项的值即value，是存在的，
        // val=“”；$('select[name="size"] option:selected').val().length为0
        var size_len=$('select[name="size"] option:selected').val().length;
        //如果有长度，说明select下拉框有被选中
        //删除原人数和人和动物数还有动物数选择下拉框中的列表除第1项外的其余选项标签。
        $('#ch-rs option:not(:first)').remove();
        $('#ch-rds option:not(:first)').remove();
        $('#ch-ds option:not(:first)').remove();
        if(size_len){
            //如果不为0，那么获取尺寸下拉框选择的tb-name属性的值
            var size_tb=$('select[name="size"] option:selected').attr('tb-name');
            //将尺寸下拉框选择的tb-name属性的值传给所有尺寸的span标签
            $('.size-span').html(size_tb);
            //把该尺寸下拉框选中的尺寸id通过ajax传给后台，获取后台发过来的匹配数据列表id以及name

    // 创建人数、人和动物数、动物数下拉选择框的选项，根据选中的器型尺寸匹配出最大数量
            var dict={7:1,8:2,9:3,10:4,11:5,12:6,13:7,14:8,15:9,16:10};
        //获取尺寸选项的值size_val
            var size_val=$('select[name="size"] option:selected').val();
            for (var j=1;j<=dict[size_val];j++){
                //创建标签<option>
                var op2='<option value='+j+'>'+j+'</option>';
                $('#ch-rs')[0].insertAdjacentHTML('beforeEnd',op2);
                $('#ch-rds')[0].insertAdjacentHTML('beforeEnd',op2);
                $('#ch-ds')[0].insertAdjacentHTML('beforeEnd',op2);
            }
//            删除人和动物数的第一项，因为最少是2
            $('select[name="ch-rds"] option[value="1"]').remove();

        //对于可选外框的控制，1，根据选中器型尺寸，匹配外框的尺寸价格 (外框种类，匹配尺寸，该类外框单位价格)
            //构造外框数据结构{外框种类id：该类外框单位价格}
            var wk_tp={0:10,1:11,2:12,3:13,4:14,5:15,6:16,7:17,8:18,9:19};
            //获取可选外框种类列表--在value,获得列表
            var wk_li=$('#kxwk-div :input[name="kxwk"]');//[2].getAttribute('tb-name')
            //先清除原来的价格标签
            $('.kxwk-price').remove();

            //再创建新的价格标签
            for(p=0;p<wk_li.length;p++){
                //从外框种类id列表中获得每一个外框种类的具体id,用dom的getAttribute('属性')
                var wk_id=wk_li[p].getAttribute('value');
                //获得该外框id单位价格
                var wk_dp=wk_tp[wk_id];
                //求该匹配尺寸下该外框的价格
                var wk_price=size_val*wk_dp;
                //保留两位小数
                var wk_price=wk_price.toFixed(2);
                //创建字符串标签
                var wk_tmp='<span style="display: inline-block; color: red" class="pull-right kxwk-price" >¥'+wk_price+'</span>';
                //插入标签,1，先把dom转成jquery，2，通过next 找到input下的lable标签，3，再通过[0]转回dom，4，最后用insertAdjacentHTML()插入
                $(wk_li[p]).next()[0].insertAdjacentHTML('beforeEnd',wk_tmp);
            }


        }else{
            //将尺寸的span标签置空
            $('.size-span').html('');
//            将人数或其他数的span置空
            $('.chrs-span').html('');
            $('.chrds-span').html('');
            $('.chds-span').html('');
            //删除可选外框的价格标签，并清空kxwk-hide里的内容
            $('.kxwk-price').remove();
            $('.kxwk-span').html('');
            $('.kxwk-hide').addClass('hidden');
            //置可选外框的input为false
            $(':radio[name="kxwk"]:checked').prop('checked',false);
        }
    }
    //作者控制函数
    function chzz() {
//        获取作者的radio值是false还是ture，就是是否有选中的。
        var chzz_tag=$(':radio[name="ch-zz"]:checked');
        var chzz=chzz_tag.prop('checked');
        if(chzz){
            var v=chzz_tag.attr('tb-name');
            var dt=chzz_tag.next().children('.ch-dt').text();
            $('.chzz-hide').removeClass('hidden');
            $('.chzz-span').html(v);
            $('.chdt-span').html(dt);//作者图样交付时间
            var im=chzz_tag.next().children('img').attr('src');
            console.log(im);
            $('.fix-img3').attr('src',im);
        }else{
            console.log(10);
            $('.chzz-hide').addClass('hidden');
            $('.chzz-span').html('');
            $('.chdt-span').html('');//作者图样交付时间
        }
    }
    //加入清单函数
    function jrqd() {
        var hdis=$('#kxwk-qd')[0].hasAttribute('disabled');
        //清除原清单中外框单价
        $('#wk-dj').text('');
        if(hdis){
            //将#wk-dj的父标签隐藏
            $('#wk-dj').parent().addClass('hidden');
            //将总价的父标签解除隐藏
            $('#ch-zj').parent().addClass('hidden');
        }else{
            //清除原清单中外框单价
            $('#wk-dj').text('');
            //获取外框价格
            var kxwk_price=$(':radio[name="kxwk"]:checked').next().children('.kxwk-price').text();
            //将外框单价放入 #wk-dj中
            $('#wk-dj').text(kxwk_price.substring(1));//substring(start,stop),截取字符串，去掉¥符号
            //将#wk-dj的父标签解除隐藏
            $('#wk-dj').parent().removeClass('hidden');
            //将总价的父标签解除隐藏
            $('#ch-zj').parent().removeClass('hidden');
        }
    }
    //    字数控制函数
    /*
    * 1,当name=ch-font的input单选框的值为value=2时，去掉‘编辑画面文字’按钮(id='font-btn')的隐藏，以及清单中font-span标签的父标签的隐藏；否则都隐藏
    * 2，当‘编辑画面文字’按钮被点击，去除textarea文件编辑框的隐藏，可以输入画面文字，
    * 2.1，点击确定按钮，又隐藏该编辑框，同时，进行编辑框中字数统计，并把字数统计结果给到清单中的font-span标签；
    * 2.2，点击取消按钮，隐藏该编辑框，同时清空编辑框中的文字，将清单中的font-span标签的字数结果清空。

    * */
    function font_world() {
        if($(':radio[name="ch-font"]:checked').val()==='2'){
            $('#font-btn').removeClass('hidden');
            $('#font-edit').removeClass('hidden');
            $('.font-span').parent().removeClass('hidden');//清单中的字数
        }else {
            $('#font-context').val('');
            $('.font-span').html('');
            $('#font-edit').addClass('hidden');
            $('#font-btn').addClass('hidden');
            $('.font-span').parent().addClass('hidden');//清单中的字数
        }
    }
    </script>
{% endblock %}


